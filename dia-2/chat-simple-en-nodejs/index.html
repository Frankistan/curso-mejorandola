<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link href="/styles/base.css" rel="stylesheet">
    <link href="/styles/plantilla-cursos.css" rel="stylesheet">    
</head>
<body>
    
    <div id="wrapper">
        <header>
            <div class="mejor"> 
              <h1><a href="http://mejorando.la" title="Mejorando.la"><img class="logo-chico" src="/images/logos/mejorandola.png" alt="Mejorando.la"><img class="logo-grande" src="/images/logos/mejorandola-grande.png" alt="Mejorando.la"></a>
              </h1>
              <a id="maestros" href="http://www.maestrosdelweb.com" title="Maestros del web"><img src="/images/logos/maestros.png" alt="Maestros del web"></a><a id="cristalab" href="http://www.cristalab.com" title="Cristalab"><img src="/images/logos/cristalab.png" alt="Cristalab"></a>
          </div>
     
            <nav class="menu">
                <ul>
                  <li><a href="http://mejorando.la/cursos" title="Cursos">Cursos</a></li>
                  <li><a href="http://mejorando.la/cursos/exalumnos" title="Ex alumnos">Ex alumnos</a></li>
                  <li><a href="http://mejorando.la/conferencias" title="Conferencias">conferencias</a></li>
                  <li><a href="http://mejorando.la/videos" title="Videos">Videos</a></li>
                </ul>
            </nav>
        </header>
        <section id="curso_head" class="small">
            <img class="portada" src="/images/javascript.jpg">
            <div class="tela"></div>
            <div class="detalles_curso">
                <div class="datos">
                    <h2 class="titulo">Curso de Javascript para aplicaciones web</h2>
                    <h4 class="fecha">Instalaci√≥n de un servidor Node.js</h4>
                </div>
            </div>
        </section> 
        <div class="lista_contenidos">
            <div class="full_contenidos">
                <h2>En Node</h2>                
                <p>Primero necesitamos instalar las librerias necesarias</p>
                <pre>npm install .</pre>
                <p>Requerimos nuestras librerias</p>
                <pre>
var http = require('http'),
    faye = require('faye');
                </pre>
                <p>Iniciamos nuestro servidor de PubSub</p>
                <pre>
bayeux.attach(server);
server.listen(8000);
                </pre>

                <h2>En el browser</h2>
                <p>Necesitamos conectarnos al servidor, decir que canales queremos escuchar y que mensajes publicar</p>
                <pre>
var client = new Faye.Client('http://localhost:8000/faye');

client.subscribe('/messages', function(message) {
    console.log('Got a message: ', message.text);
});

client.publish('/messages', {
    text: 'Hello world'
});                      
                </pre>

                <h2>Faye permite tener extensiones</h2>
                <p>Para agregar comportamiento a nuestro server pub sub tenemos extensiones que se corren antes de cualquier mensaje que salga del server o cuando cualquier mensaje llegue el server</p>
                <pre>
var logger = {
  incoming: function(message, callback) {
    if(message.channel === '/messages'){
      console.log('got message', message.data);
    }

    callback(message);
  }
};

bayeux.addExtension(logger);
                </pre>

                <h2>Veamos el ejemplo</h2>
                <p>Vayan al folder /dia-2/chat-simple-en-nodejs</p>
                <pre>node app.js</pre>
                <p>Vatan a <a href="http://localhost:9000/dia-2/chat-simple-en-nodejs/ejemplo.html">http://localhost:9000/dia-2/chat-simple-en-nodejs/ejemplo.html</a></p>
            </div>        
        </div>        
    </div>    
</body>
</html>